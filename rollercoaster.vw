{
  "version": "1.0",
  "created_at": "2025-12-24T05:46:21.883415",
  "description": "k help Create the 3D rollercoaster ride game from the perspective of the rider where a user can ride a roller coaster, speed up/down. The rollercoaster\n                    should be specified by the data values of a histogram of that column. A user can toggle which column to get the histogram of. \n                    ",
  "code": "import * as THREE from \"https://esm.sh/three@0.160.0\";\nimport * as d3 from \"https://esm.sh/d3@7\";\n\nconst THEME = {\n  deepWater: \"#05161a\",\n  midnightTeal: \"#072e33\",\n  electricCyan: \"#00f0ff\",\n  seaSalt: \"#f0f9f9\",\n  sandGrey: \"#94a3b8\",\n  emeraldGreen: \"#10b981\",\n  hibiscusRed: \"#ef4444\",\n  sunlightYellow: \"#facc15\",\n  fontFamily: \"'Montserrat', sans-serif\",\n  monoFamily: \"'JetBrains Mono', monospace\",\n};\n\nexport const ControlPanel = ({ html, columns, selectedCol, onColChange, speed, onSpeedChange }) => {\n  return html`\n    <div style=${{\n      position: 'absolute',\n      top: '20px',\n      left: '20px',\n      zIndex: 100,\n      background: 'rgba(5, 22, 26, 0.85)',\n      padding: '16px',\n      borderRadius: '8px',\n      border: `1px solid ${THEME.electricCyan}44`,\n      backdropFilter: 'blur(8px)',\n      color: THEME.seaSalt,\n      fontFamily: THEME.fontFamily,\n      width: '220px',\n      boxShadow: `0 4px 20px rgba(0,0,0,0.4)`\n    }}>\n      <div style=${{ marginBottom: '12px' }}>\n        <label style=${{ display: 'block', fontSize: '10px', textTransform: 'uppercase', color: THEME.sandGrey, marginBottom: '4px' }}>Data Track</label>\n        <select \n          value=${selectedCol} \n          onChange=${(e) => onColChange(e.target.value)}\n          style=${{\n            width: '100%',\n            background: THEME.midnightTeal,\n            color: THEME.seaSalt,\n            border: `1px solid ${THEME.electricCyan}`,\n            padding: '4px',\n            borderRadius: '4px',\n            outline: 'none'\n          }}\n        >\n          ${columns.map(col => html`<option value=${col}>${col}</option>`)}\n        </select>\n      </div>\n      <div>\n        <label style=${{ display: 'block', fontSize: '10px', textTransform: 'uppercase', color: THEME.sandGrey, marginBottom: '4px' }}>Engine Power</label>\n        <input \n          type=\"range\" \n          min=\"0.001\" \n          max=\"0.02\" \n          step=\"0.001\" \n          value=${speed} \n          onInput=${(e) => onSpeedChange(parseFloat(e.target.value))}\n          style=${{ width: '100%', accentColor: THEME.electricCyan }}\n        />\n      </div>\n      <div style=${{ marginTop: '12px', fontSize: '11px', color: THEME.electricCyan, fontFamily: THEME.monoFamily }}>\n        Riding: ${selectedCol}\n      </div>\n    </div>\n  `;\n};\n\nexport default function RollercoasterWidget({ model, html, React }) {\n  const containerRef = React.useRef(null);\n  const data = model.get(\"data\") || [];\n  const [selectedCol, setSelectedCol] = React.useState(\"Age\");\n  const [speed, setSpeed] = React.useState(0.005);\n\n  const numericCols = React.useMemo(() => {\n    if (!data.length) return [];\n    return Object.keys(data[0]).filter(k => typeof data[0][k] === 'number');\n  }, [data]);\n\n  React.useEffect(() => {\n    if (!containerRef.current) return;\n\n    const width = containerRef.current.clientWidth;\n    const height = 500;\n\n    const scene = new THREE.Scene();\n    scene.background = new THREE.Color(THEME.deepWater);\n    scene.fog = new THREE.FogExp2(THEME.deepWater, 0.015);\n\n    const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);\n    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n    renderer.setSize(width, height);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    containerRef.current.appendChild(renderer.domElement);\n\n    // Lighting\n    const ambientLight = new THREE.AmbientLight(0x404040, 2);\n    scene.add(ambientLight);\n    const pointLight = new THREE.PointLight(THEME.electricCyan, 2, 100);\n    scene.add(pointLight);\n\n    // Track generation from Histogram\n    const rawValues = data.map(d => d[selectedCol]).filter(v => v != null && !isNaN(v));\n    const counts = d3.bin().thresholds(20)(rawValues);\n    \n    const points = [];\n    const trackWidth = 400;\n    counts.forEach((bin, i) => {\n      const x = (i / counts.length) * trackWidth - (trackWidth / 2);\n      const y = (bin.length / data.length) * 150; // Height based on density\n      const z = Math.sin(i * 0.5) * 20; // Some curves\n      points.push(new THREE.Vector3(x, y, z));\n    });\n\n    // Smooth the track\n    const curve = new THREE.CatmullRomCurve3(points, true, 'centripetal');\n    const tubeGeometry = new THREE.TubeGeometry(curve, 200, 0.5, 8, false);\n    const tubeMaterial = new THREE.MeshStandardMaterial({ \n      color: THEME.electricCyan, \n      emissive: THEME.electricCyan,\n      emissiveIntensity: 0.5,\n      wireframe: true \n    });\n    const trackMesh = new THREE.Mesh(tubeGeometry, tubeMaterial);\n    scene.add(trackMesh);\n\n    // Add \"supports\" (ocean floor pillars)\n    const pillarGeo = new THREE.CylinderGeometry(0.2, 0.2, 200, 6);\n    const pillarMat = new THREE.MeshStandardMaterial({ color: THEME.midnightTeal });\n    points.forEach((p, i) => {\n      if (i % 2 === 0) {\n        const pillar = new THREE.Mesh(pillarGeo, pillarMat);\n        pillar.position.set(p.x, p.y - 100, p.z);\n        scene.add(pillar);\n      }\n    });\n\n    // Animation state\n    let progress = 0;\n    let requestRef;\n\n    const animate = () => {\n      progress += speed;\n      if (progress > 1) progress = 0;\n\n      const pos = curve.getPointAt(progress);\n      const lookAt = curve.getPointAt((progress + 0.01) % 1);\n      \n      camera.position.copy(pos);\n      camera.position.y += 2; // Offset rider height\n      camera.lookAt(lookAt);\n      \n      pointLight.position.copy(pos);\n\n      renderer.render(scene, camera);\n      requestRef = requestAnimationFrame(animate);\n    };\n\n    requestRef = requestAnimationFrame(animate);\n\n    return () => {\n      cancelAnimationFrame(requestRef);\n      renderer.dispose();\n      if (containerRef.current) {\n        containerRef.current.removeChild(renderer.domElement);\n      }\n    };\n  }, [selectedCol, speed, data]);\n\n  return html`\n    <div style=${{ \n      position: 'relative', \n      width: '100%', \n      height: '500px', \n      background: THEME.deepWater,\n      overflow: 'hidden',\n      borderRadius: '12px',\n      border: `1px solid ${THEME.midnightTeal}`\n    }}>\n      <${ControlPanel} \n        html=${html}\n        columns=${numericCols}\n        selectedCol=${selectedCol}\n        onColChange=${setSelectedCol}\n        speed=${speed}\n        onSpeedChange=${setSpeed}\n      />\n      <div ref=${containerRef} style=${{ width: '100%', height: '100%' }}></div>\n      <div style=${{\n        position: 'absolute',\n        bottom: '20px',\n        right: '20px',\n        color: THEME.seaSalt,\n        fontFamily: THEME.fontFamily,\n        fontSize: '12px',\n        textAlign: 'right',\n        pointerEvents: 'none',\n        textShadow: '0 2px 4px rgba(0,0,0,0.5)'\n      }}>\n        <div style=${{ fontWeight: 'bold', color: THEME.electricCyan }}>AZURE REEF RIDE</div>\n        <div>Histogram-based 3D Generation</div>\n      </div>\n    </div>\n  `;\n}",
  "outputs": {},
  "inputs_signature": {
    "data": "<input>"
  },
  "theme": {
    "name": "scuba_caribbean",
    "description": "This theme, titled **\"Azure Reef,\"** captures the vibrant, high-contrast clarity of a tropical dive, blending deep oceanic foundations with the luminous, neon-adjacent colors of a sunlit coral shelf.\n\nThe environment is a sophisticated dark mode that mimics the depths of the Caribbean Sea. The primary ground is a **deep, desaturated midnight teal**, providing a rich, cool-toned backdrop that ensures maximum contrast for data. Secondary surfaces\u2014such as cards and widget containers\u2014are styled in a **slightly more translucent \"Deep Water\" navy**, separated from the ground by a crisp, 1-pixel border in a faint sea-foam green. The overall feeling is technical yet refreshing, avoiding the \"flatness\" of pure black in favor of a layered, immersive aquatic atmosphere.\n\nTypography is anchored by **Montserrat** for body text and headers, providing a clean, geometric, and highly legible humanist feel that suggests modern exploration. For data values and code, **JetBrains Mono** is used to provide a sharp, technical texture. Text is rendered in a **bright \"Sea Salt\" white** (WCAG AA compliant) for primary labels, while secondary metadata uses a **muted \"Sand\" grey** to maintain a clear visual hierarchy.\n\nThe color system is driven by a **saturated Electric Cyan** accent, which acts as the primary interactive signal, glowing against the dark background. Semantic states are integrated with high-visibility tropical hues: **Emerald Green** for success, **Vivid Amber** for warnings, and **Hibiscus Red** for errors. The **Categorical Palette** is a 10-color \"Coral Reef\" sequence featuring high-contrast, colorblind-safe shades of Turquoise, Flamingo Pink, Sun-Bleached Yellow, and Bright Violet. The **Sequential Palette** transitions from a **dim, translucent kelp-green** to a **blindingly bright neon aqua**, representing depth or intensity through both luminosity and saturation. The **Diverging Palette** uses a **warm Sunset Orange** on one end and a **cool Deep Cobalt** on the other, meeting at a **neutral, desaturated slate** midpoint.\n\nChart elements are designed to be unobtrusive but structural. Axes are rendered in a **thin, 0.5px stroke of \"Mist\" grey**, while gridlines are nearly invisible, appearing only as **subtle, widely spaced dotted lines** that suggest the refraction of light through water. The chart frame itself is open and airy, allowing data marks to float freely without being boxed in.\n\nInteractions feel **buoyant and fluid**. On hover, data marks should undergo a **subtle \"glow\" effect** (an outer shadow of the mark's color) and a slight scale increase of 5%. Focus rings for keyboard navigation are a **thick, high-contrast \"Sunlight\" Yellow** to ensure no ambiguity. Tooltips are styled as **floating glassmorphic cards** with a blurred background and a sharp, white border, making them pop as if they are bubbles rising to the surface. Default mark opacity is set to **85%**, allowing overlapping data points to build up in saturation, mimicking the way light intensifies in shallow, crowded waters."
  },
  "components": [
    "ControlPanel"
  ],
  "model": "google/gemini-3-flash-preview",
  "audit": null,
  "save_inputs": {
    "embedded": false,
    "values": {}
  }
}