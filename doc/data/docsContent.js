export const DOC_SITE = {
    name: 'Vibe Widget',
    description: 'Interactive widgets for notebooks, generated from natural language and data.',
    baseUrl: 'https://vibewidget.dev',
    repoUrl: 'https://github.com/dwootton/vibe-widgets',
    installCommand: 'pip install vibe-widget',
    securitySummary: 'Widgets execute LLM-generated JavaScript in the notebook frontend. Treat outputs as untrusted and verify results with audits and your own checks.',
    changelogUrl: 'https://github.com/dwootton/vibe-widgets/blob/main/CHANGELOG.md',
    docsExportPath: '/docs-export.json',
    docsTextPath: '/docs.txt',
};

export const DOC_NAV = [
    {
        title: 'Getting Started',
        links: [
            { label: 'Installation', path: '/docs' },
            { label: 'Configuration', path: '/docs/config' },
        ],
    },
    {
        title: 'Core Concepts',
        links: [
            { label: 'Create', path: '/docs/create' },
            { label: 'Edit', path: '/docs/edit' },
            { label: 'Audit', path: '/docs/audit' },
            { label: 'Reactivity', path: '/docs/reactivity' },
            { label: 'Data Sources', path: '/docs/data-sources' },
            { label: 'Composability', path: '/docs/composability' },
        ],
    },
    {
        title: 'Live Examples',
        links: [
            { label: 'Cross-Widget Demo', path: '/docs/examples/cross-widget' },
            { label: 'Tic-Tac-Toe AI', path: '/docs/examples/tictactoe' },
            { label: 'PDF & Web Data', path: '/docs/examples/pdf-web' },
            { label: 'Edit Example', path: '/docs/examples/edit' },
        ],
    },
    {
        title: 'Ecosystem',
        links: [
            { label: 'Widgetarium', path: '/docs/widgetarium' },
        ],
    },
];

const DOC_PAGES_LIST = [
    {
        id: 'installation',
        path: '/docs',
        title: 'Installation',
        description: 'Get up and running with Vibe Widget in seconds.',
        blocks: [
            { type: 'lead', text: 'Get up and running with Vibe Widget in seconds.' },
            { type: 'code', language: 'bash', code: 'pip install vibe-widget' },
            { type: 'paragraph', text: 'Vibe Widget requires Python 3.8+ and an OpenRouter API key.' },
            { type: 'code', language: 'bash', code: "export OPENROUTER_API_KEY='your-key'" },
            { type: 'heading', level: 2, text: 'Quick start' },
            {
                type: 'code',
                language: 'python',
                code: [
                    'import pandas as pd',
                    'import vibe_widget as vw',
                    '',
                    'df = pd.read_csv("sales.csv")',
                    '',
                    'widget = vw.create(',
                    '    "scatter plot with brush selection, and a linked histogram",',
                    '    df,',
                    '    outputs=vw.outputs(selected_indices="indices of selected points")',
                    ')',
                    '',
                    'widget',
                ].join('\n'),
            },
        ],
    },
    {
        id: 'config',
        path: '/docs/config',
        title: 'Configuration',
        description: 'Configure model settings and API keys.',
        blocks: [
            { type: 'paragraph', text: 'Configure model settings and API keys.' },
            { type: 'heading', level: 2, text: 'Set defaults' },
            {
                type: 'code',
                language: 'python',
                code: [
                    'import vibe_widget as vw',
                    '',
                    'vw.config(model="openai/gpt-5.2-codex")',
                    'vw.config(mode="premium", model="openrouter")',
                    'vw.config(execution="approve")',
                ].join('\n'),
            },
            { type: 'heading', level: 2, text: 'API key setup' },
            { type: 'code', language: 'bash', code: "export OPENROUTER_API_KEY='your-key'" },
            {
                type: 'code',
                language: 'python',
                code: [
                    'import os',
                    'from dotenv import load_dotenv',
                    'import vibe_widget as vw',
                    '',
                    'load_dotenv()',
                    'api_key = os.getenv("MY_SECRET_API_KEY")',
                    '',
                    'vw.config(api_key=api_key)',
                ].join('\n'),
            },
            { type: 'paragraph', text: 'We recommend avoiding hardcoded keys in notebooks to prevent accidental leaks.' },
            { type: 'heading', level: 2, text: 'Models' },
            {
                type: 'code',
                language: 'python',
                code: ['vw.models()', 'vw.models(show="all")', 'vw.models(verbose=False)'].join('\n'),
            },
            { type: 'heading', level: 2, text: 'Privacy and telemetry' },
            { type: 'paragraph', text: 'Vibe Widget sends the following to the model provider:' },
            {
                type: 'list',
                items: [
                    'your prompt and theme prompt',
                    'data schema (column names, dtypes)',
                    'a small sample of rows (up to 3)',
                    'outputs/inputs descriptors',
                    'full widget code for edits, audits, and runtime fixes',
                    'runtime error messages (when auto-fixing)',
                ],
            },
            { type: 'paragraph', text: 'No API keys are written to disk. Generated widgets and audit reports are stored locally in <code>.vibewidget/</code>.' },
        ],
    },
    {
        id: 'create',
        path: '/docs/create',
        title: 'Create',
        description: 'Create widgets from natural language prompts and data sources.',
        blocks: [
            { type: 'paragraph', text: 'Create widgets from natural language prompts and data sources.' },
            {
                type: 'code',
                language: 'python',
                code: [
                    'import vibe_widget as vw',
                    '',
                    'widget = vw.create(',
                    '    "bar chart of revenue by region",',
                    '    df',
                    ')',
                    '',
                    'widget',
                ].join('\n'),
            },
            { type: 'heading', level: 2, text: 'Inputs and outputs' },
            { type: 'paragraph', text: 'Use <code>vw.inputs</code> to pass multiple inputs, and <code>vw.outputs</code> to define reactive state your widget exposes.' },
            {
                type: 'code',
                language: 'python',
                code: ['vw.create(', '    "...",', '    vw.inputs(df, selected_indices=other_widget.outputs.selected_indices)', ')'].join('\n'),
            },
            {
                type: 'code',
                language: 'python',
                code: [
                    'scatter = vw.create(',
                    '    "scatter with brush selection",',
                    '    df,',
                    '    outputs=vw.outputs(selected_indices="indices of selected points")',
                    ')',
                    '',
                    'scatter.outputs.selected_indices.value',
                ].join('\n'),
            },
            { type: 'heading', level: 2, text: 'Dataflow and I/O contract' },
            {
                type: 'paragraph',
                text: '<code>vw.create</code> converts data to a list of record dicts and cleans non-JSON values (NaN/NaT/inf to <code>None</code>). Inputs and outputs are synced traitlets. When providing another widget output, Vibe Widget reads the current value once, then keeps it in sync via trait updates. Outputs start as <code>None</code> and are updated by generated JS code.',
            },
            { type: 'heading', level: 2, text: 'Supported data sources' },
            {
                type: 'list',
                items: [
                    '<code>pandas.DataFrame</code>',
                    'local file paths (CSV/TSV, JSON/GeoJSON, Parquet, NetCDF, XML, ISF, Excel, PDF, TXT)',
                    'URLs (via <code>crawl4ai</code>, best-effort)',
                ],
            },
            { type: 'paragraph', text: 'Some loaders require optional dependencies (for example, <code>xarray</code> for NetCDF or <code>camelot</code> for PDF).' },
            { type: 'heading', level: 2, text: 'Theming' },
            { type: 'paragraph', text: 'Themes are natural-language design specs that guide code generation.' },
            {
                type: 'code',
                language: 'python',
                code: ['vw.create("...", df, theme="financial_times")', '', 'vw.create("...", df, theme="like national geographic but greener")'].join('\n'),
            },
            { type: 'paragraph', text: 'Built-in themes are listed via <code>vw.themes()</code>. Theme prompts are cached for the session and can be saved locally.' },
            { type: 'heading', level: 2, text: 'Safety warning' },
            { type: 'paragraph', text: 'Widgets execute LLM-generated JavaScript in the notebook frontend. Treat generated code as untrusted. Use audits and your own verification when the output informs decisions.' },
        ],
    },
    {
        id: 'theming',
        path: '/docs/theming',
        title: 'Theming',
        description: 'Style widgets with natural-language design specs.',
        blocks: [
            { type: 'paragraph', text: 'Themes are natural-language design specs that guide code generation.' },
            { type: 'heading', level: 2, text: 'List available themes' },
            { type: 'code', language: 'python', code: ['import vibe_widget as vw', '', 'vw.themes()'].join('\n') },
            { type: 'heading', level: 2, text: 'Create a custom theme' },
            {
                type: 'code',
                language: 'python',
                code: [
                    'theme = vw.theme("like national geographic but greener")',
                    '',
                    '# Inspect or reuse the generated description',
                    'print(theme.description)',
                    '',
                    'vw.create("...", df, theme=theme.description)',
                ].join('\n'),
            },
            { type: 'heading', level: 2, text: 'Use a theme in create' },
            { type: 'code', language: 'python', code: 'vw.create("...", df, theme="financial_times")' },
        ],
    },
    {
        id: 'edit',
        path: '/docs/edit',
        title: 'Edit',
        description: 'Iterate on generated widgets using code or the UI.',
        blocks: [
            { type: 'paragraph', text: 'While developing interactive widgets, we often do not know what to fully specify until after the first version exists. Vibe Widget makes iteration a first-class workflow by letting you edit generated widgets through code or the UI.' },
            { type: 'paragraph', text: 'Edits reuse existing code and optionally the theme, then apply requested changes. Each edit produces a new widget instance and persists a new version in the widget store.' },
            { type: 'heading', level: 2, text: 'Python edits' },
            { type: 'paragraph', text: 'Use Python edits when you want structural changes, broader logic refactors, or to preserve edits as code in notebooks and scripts. Python edits are ideal for larger, explicit changes you want to keep versioned and reproducible.' },
            {
                type: 'code',
                language: 'python',
                code: ['v1 = vw.create("basic scatter", df)', '', '# Large or structural changes', 'v2 = v1.edit("add hover tooltips and a right-side legend")'].join('\n'),
            },
            { type: 'paragraph', text: 'Component-level edits are ideal when the widget exposes named subcomponents and you want precise changes without rewriting the full widget.' },
            {
                type: 'code',
                language: 'python',
                code: ['# Example: targeted edits via components', 'v3 = v1.component.colo_legend.edit("style the legend with a muted palette", inputs=df)'].join('\n'),
            },
            { type: 'heading', level: 2, text: 'UI edits' },
            { type: 'paragraph', text: 'Use UI edits for fast, interactive iteration inside the widget runtime. These are best for targeted adjustments, quick fixes, and diagnostics without switching to code.' },
            { type: 'heading', level: 3, text: 'Source code editing' },
            { type: 'paragraph', text: 'Make precise changes in the generated JS/HTML/CSS when you need direct control over logic or styling.' },
            { type: 'placeholder', label: 'Image Placeholder', caption: 'Source code editor UI with highlighted widget files.' },
            { type: 'heading', level: 3, text: 'Visual editing (Edit Element)' },
            { type: 'paragraph', text: 'Select a specific element by its bounding box and issue an edit scoped to that element, using full context from the widget.' },
            { type: 'placeholder', label: 'Image Placeholder', caption: 'Edit Element UI showing bounding boxes and selected element context.' },
            { type: 'heading', level: 3, text: 'Auditing' },
            { type: 'paragraph', text: 'Detect issues, get recommendations, and optionally turn a concern into a fix request.' },
            { type: 'placeholder', label: 'Image Placeholder', caption: 'Audit panel UI with issue list and recommendations.' },
            { type: 'heading', level: 2, text: 'Code Auditing' },
            { type: 'paragraph', text: 'Audits review the current widget code and description to surface concerns, design risks, and fixes. This is designed to help you catch issues early and guide the next edit.' },
            {
                type: 'table',
                headers: ['Level', 'Scope', 'When to Use', 'Output'],
                rows: [
                    ['fast', 'Quick scan for top issues', 'Early iterations, frequent checks', 'Short concern list + fixes'],
                    ['full', 'Deeper review, alternatives', 'Pre-share, production polish', 'Detailed concerns + options'],
                ],
            },
            { type: 'heading', level: 3, text: 'How to use auditing' },
            { type: 'paragraph', text: 'You can run audits from Python to get a structured report without needing to re-run the widget UI.' },
            {
                type: 'code',
                language: 'python',
                code: ['# Run a fast audit and return a report', 'report = widget.audit(level="fast", display=False)', '', '# Deep audit for detailed alternatives', 'full_report = widget.audit(level="full", reuse=True, display=False)'].join('\n'),
            },
            { type: 'paragraph', text: 'In the UI, audit recommendations can be surfaced as a checklist. You can then turn a specific concern into an edit request or keep it as a TODO for later.' },
            { type: 'heading', level: 3, text: 'Examples' },
            { type: 'code', language: 'python', code: '# Use audit output to guide the next change\nwidget.edit("fix accessibility issues mentioned in the audit report")' },
        ],
    },
    {
        id: 'audit',
        path: '/docs/audit',
        title: 'Audit',
        description: 'Review widget code and behavior for risks, usability issues, and design gaps.',
        blocks: [
            { type: 'paragraph', text: 'Audits review widget code and behavior through a set of lenses to surface risks, usability issues, and design gaps before you ship.' },
            { type: 'heading', level: 2, text: 'Audit framework' },
            { type: 'paragraph', text: 'Each audit runs across domains and lenses so you get feedback that is both technical and experiential.' },
            {
                type: 'table',
                headers: ['Domain', 'What It Covers', 'Key Questions'],
                rows: [
                    ['DATA', 'Input, filtering, transformations, formatting. Subdomains: <code>data.input</code>, <code>data.filtering</code>, <code>data.transformations</code>, <code>data.formatting</code>.', 'What goes in? What gets dropped? How is it changed?'],
                    ['COMPUTATION', 'Algorithms, parameters, assumptions. Subdomains: <code>computation.algorithm</code>, <code>computation.parameters</code>, <code>computation.assumptions</code>.', 'What runs? With what settings? What does it assume?'],
                    ['PRESENTATION', 'Visual encoding, scales, projection. Subdomains: <code>presentation.encoding</code>, <code>presentation.scales</code>, <code>presentation.projection</code>.', 'How are results shown? What is hidden or over-emphasized?'],
                    ['INTERACTION', 'Triggers, state, propagation. Subdomains: <code>interaction.triggers</code>, <code>interaction.state</code>, <code>interaction.propagation</code>.', 'What changes on input? What persists? What updates downstream?'],
                    ['SYSTEM', 'Accessibility, performance, reliability. Subdomains: <code>system.accessibility</code>, <code>system.performance</code>, <code>system.reliability</code>.', 'Is it usable for everyone? Is it fast and stable?'],
                ],
            },
            { type: 'paragraph', text: 'Each domain is reviewed at a second level to pinpoint the issue scope, such as <code>data.transformations</code> or <code>computation.parameters.bin_size</code>, so fixes stay targeted and explainable.' },
            { type: 'heading', level: 2, text: 'Audit lenses' },
            { type: 'paragraph', text: 'Lenses are the perspectives applied during auditing. You can think of them as different expert reviews running together, such as accessibility, data integrity, or interaction design.' },
            { type: 'heading', level: 2, text: 'Fast vs full audits' },
            { type: 'paragraph', text: '<strong>Fast</strong> audits provide quick issue scans for early iteration. <strong>Full</strong> audits dig deeper with alternatives and higher coverage for pre-share polish.' },
            {
                type: 'code',
                language: 'python',
                code: ['# Fast audit for quick checks', 'report = widget.audit(level="fast", display=False)', '', '# Full audit for deeper review', 'full_report = widget.audit(level="full", reuse=True, display=False)'].join('\n'),
            },
            { type: 'paragraph', text: 'Audit outputs are stored in <code>.vibewidget/audits</code> as JSON and YAML.' },
            { type: 'heading', level: 2, text: 'Launch an audit' },
            { type: 'heading', level: 3, text: 'Before widget render (Python)' },
            { type: 'placeholder', label: 'GIF Placeholder', caption: 'Run audit from Python before rendering the widget output.' },
            { type: 'heading', level: 3, text: 'During UI editing' },
            { type: 'placeholder', label: 'GIF Placeholder', caption: 'Launch audit while editing the widget in the UI.' },
            { type: 'heading', level: 2, text: 'Example audit results' },
            {
                type: 'placeholder',
                label: 'Sample Output',
                caption: '<ul class="static-list"><li>Data: Axis label missing units for "Revenue".</li><li>Accessibility: Hover tooltips are not keyboard reachable.</li><li>Design: Secondary controls compete with chart for visual emphasis.</li></ul>',
                allowHtmlCaption: true,
            },
        ],
    },
    {
        id: 'reactivity',
        path: '/docs/reactivity',
        title: 'Reactivity',
        description: 'Connect widgets with reactive inputs and outputs.',
        blocks: [
            { type: 'paragraph', text: 'Outputs are reactive state handles that can be passed into other widgets.' },
            {
                type: 'code',
                language: 'python',
                code: [
                    'scatter = vw.create(',
                    '    "scatter plot with brush selection tool",',
                    '    df,',
                    '    outputs=vw.outputs(selected_indices="indices of selected points")',
                    ')',
                    '',
                    'histogram = vw.create(',
                    '    "histogram with highlighted bars for selected data",',
                    '    vw.inputs(df, selected_indices=scatter.outputs.selected_indices)',
                    ')',
                ].join('\n'),
            },
            { type: 'paragraph', text: 'When you select points in the scatter plot, the histogram updates via trait syncing. Outputs are exposed under <code>widget.outputs.&lt;name&gt;</code>.' },
        ],
    },
    {
        id: 'data-sources',
        path: '/docs/data-sources',
        title: 'Data Sources',
        description: 'Supported inputs and loaders.',
        blocks: [
            { type: 'paragraph', text: 'This documentation section is under construction.' },
        ],
    },
    {
        id: 'composability',
        path: '/docs/composability',
        title: 'Composability',
        description: 'Compose widgets using components and outputs.',
        blocks: [
            { type: 'paragraph', text: 'This documentation section is under construction.' },
        ],
    },
    {
        id: 'widgetarium',
        path: '/docs/widgetarium',
        title: 'Widgetarium',
        description: 'The ecosystem of widgets and templates.',
        blocks: [
            { type: 'paragraph', text: 'This documentation section is under construction.' },
        ],
    },
    {
        id: 'example-cross-widget',
        path: '/docs/examples/cross-widget',
        title: 'Cross-Widget Interactions',
        description: 'Interactive notebook example for cross-widget state sharing.',
        blocks: [
            { type: 'paragraph', text: 'This example is interactive in the live docs. The static mirror includes a summary only.' },
            { type: 'paragraph', text: 'Open the live docs to run the notebook and explore the linked widgets.' },
        ],
    },
    {
        id: 'example-tictactoe',
        path: '/docs/examples/tictactoe',
        title: 'Tic-Tac-Toe AI',
        description: 'Interactive notebook example for game logic and UI.',
        blocks: [
            { type: 'paragraph', text: 'This example is interactive in the live docs. The static mirror includes a summary only.' },
            { type: 'paragraph', text: 'Open the live docs to run the notebook and explore the game widget.' },
        ],
    },
    {
        id: 'example-pdf-web',
        path: '/docs/examples/pdf-web',
        title: 'PDF & Web Data Extraction',
        description: 'Interactive notebook example for scraping and parsing.',
        blocks: [
            { type: 'paragraph', text: 'This example is interactive in the live docs. The static mirror includes a summary only.' },
            { type: 'paragraph', text: 'Open the live docs to run the notebook and explore PDF/web extraction.' },
        ],
    },
    {
        id: 'example-edit',
        path: '/docs/examples/edit',
        title: 'Widget Editing',
        description: 'Interactive notebook example for editing workflows.',
        blocks: [
            { type: 'paragraph', text: 'This example is interactive in the live docs. The static mirror includes a summary only.' },
            { type: 'paragraph', text: 'Open the live docs to run the notebook and explore editing workflows.' },
        ],
    },
];

export const DOC_PAGES = DOC_PAGES_LIST;
export const DOC_PAGE_MAP = Object.fromEntries(DOC_PAGES_LIST.map((page) => [page.id, page]));
